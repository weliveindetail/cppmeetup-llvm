<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>LLVM-based JIT Compilers</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/monokai-sublime.css">

    <style>
      .reveal .slides section code {
        font-size: 0.8em; }

      .reveal .slides section img.logo-tr { 
        border: 0px;
        margin: 0px;
        margin-top: -20px;
        opacity: 1.0;
        float: right; }

      .reveal .slides section.section-tl {
        text-align: left;
        vertical-align: top; }

      .reveal .slides section img.abspos {
        position: absolute;
        width: 200px;
        height: auto;
        margin: 0px;
        border: 0px; }

      .reveal .slides section img.replace {
        width: 0px;
        height: 0px;
        margin: 0px;
        border: 0px;
        transition: none; }

      .reveal .slides section img.replace.fragment.current-visible {
        opacity: 0;
        visibility: hidden;
        display: none; }

      .reveal .slides section img.replace.fragment.current-visible.current-fragment {
        opacity: 1;
        width: 100%;
        height: auto;
        visibility: visible;
        display: inline; }
    </style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

				<section>
          <img data-src="img/llvm-logo.svg" width="300" height="300" alt="xxx" style="border: 0px; margin: 2px;">
					<h2>LLVM-based JIT Compilers</h2>
					<small style="width: 72%; padding: 10px 0px;">
            <table style="width: 100%;">
              <tr><td style="text-align: right;">
                Stefan Gränitz @ C++ Meetup, Berlin<br>
                Tuesday, March 15th 2016<br>
                <br>
                <br>
              </td></tr>
              <tr><td>
                <a href="mailto:stefan.graenitz@gmail.com">
                  <img data-src="img/icons/grey-mail.png" alt="xxx" style="border: 0px; width: 24px; height: 24px; margin: 2px;">
                  stefan.graenitz@gmail.com
                </a>
                <br>
                <a target="_blank" href="https://twitter.com/weliveindetail">
                  <img data-src="img/icons/grey-github.png" alt="xxx" style="border: 0px; width: 24px; height: 24px; margin: 2px;">
                  github.com/weliveindetail
                </a>
                <br>
                <a target="_blank" href="https://twitter.com/weliveindetail">
                  <img data-src="img/icons/grey-twitter.png" alt="xxx" style="border: 0px; width: 24px; height: 24px; margin: 2px;">
                  @weliveindetail
                </a>
              </td></tr>
            </table>
					</small>
				</section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h3 style="text-align: left;">What is a...</h3>
            <h1 style="text-align: center;">JIT Compiler?</h1>
          </section>
          <section style="text-align: left;">
            <h3>What is a JIT Compiler?</h3>
            <br>
            <b>Compiler</b><br>
            <ul>
              <li>&rarr; code transformations to bridge abstraction gap between hardware and software</li>
              <li>&rarr; typically from high-level source code to<br> low-level machine code</li>
            </ul>
            <br>
            <b>Just-In-Time</b><br>
            <ul>
              <li>&rarr; as close as possible to its actual execution</li>
            </ul>
            <aside class="notes">
              compiler: there are others like cross- &amp; source-to-source compilers (new fancy name transpilers)
            </aside>
          </section>
          <section style="text-align: left;">
            <h3>What people mean with JIT Compiler?</h3>
            <br>
            <blockquote cite="http://eli.thegreenplace.net/2013/11/05/how-to-jit-an-introduction">
              Whenever a program, while running, creates and runs some new executable code 
              which was not part of the program when it was stored on disk, it’s a JIT.
              <cite>Eli Bendersky</cite>
            </blockquote>
            <br>
            &rarr; widely used as a synonym for <b style="color: #c33;">Runtime Compiler</b>
            <br>
            &rarr; AOT means <b style="color: #c33;">Static Compiler</b>
          </section>
          <section style="text-align: left;">
            <h3>Difference Static vs. Runtime Compiler?</h3>
            <br>
            todo
          </section>
        </section>

        <section>
          <section>
            <h3 style="text-align: left;">What is...</h3>
            <h1 style="text-align: center;">LLVM?</h1>
          </section>
          <section style="text-align: left;">
            <h3>What is LLVM?</h3>
            <ul>
              <li>&rarr; compiler infrastructure:<br>intermediate representation and tools to manipulate it</li>
              <li>&rarr; started in 2003 by <a target="_blank" href="https://en.wikipedia.org/wiki/Chris_Lattner">Chris Lattner</a> (University of Illinois) as <i>Low Level Virtual Machine</i></li>
              <li>&rarr; today developed by the <a target="_blank" href="http://llvm.org/">LLVM Developer Group</a></li>
            </ul>
          </section>
          <section style="text-align: left;">
            <h3>Why is that interesting for C++ devs?</h3>
            <ul>
              <li>&rarr; huge code base:<br>open-source, modern C++</li>
              <li>&rarr; sophisticated requirements:<br>modularity, portability, efficiency</li>
              <li>&rarr; components that you might like to use</li>
              <li>&rarr; great development tools</li>
            </ul>
            <br>
            &hellip; and a good craftsman should know his tools!
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h1 style="text-align: center;">Projects</h1>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/llvm-logo.svg" width="400" height="400" alt="xxx" class="logo-tr">
            <br><br><br><br><br>
            <h3 style="margin: 0px;">Clang &mdash; a compiler</h3>
            <a target="_blank" href="http://clang.llvm.org/">http://clang.llvm.org/</a>
            <ul>
              <li>&rarr; LLVM reference project</li>
              <li>&rarr; self-hosting since February, 2nd 2010</li>
              <li>&rarr; actively developed by Apple, Google, Microsoft, ARM, Sony, Intel, AMD, etc. &amp; the community</li>
              <li>&rarr; a great playground, also for the C++ standards committee</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/root-banner.png" width="529" height="128" alt="xxx" class="logo-tr" style="margin-right: -56px;">
            <br><br><br>
            <h3 style="margin: 0px;">Cling &mdash; an interpreter</h3>
            <a target="_blank" href="https://root.cern.ch/cling-brief">https://root.cern.ch/cling-brief</a>
            <ul>
              <li>&rarr; replaces old CINT command line interpreter</li>
              <li>&rarr; rapid development tool for high energy physicists</li>
              <li>&rarr; let's see it in action!</li>
            </ul>
            <br>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/google-logo.png" width="200" height="200" alt="xxx" class="logo-tr">
            <br><br><br><br>
            <h3 style="margin: 0px;">AddressSanitizer &mdash; a development tool</h3>
            <a target="_blank"
               href="https://github.com/google/sanitizers/wiki/AddressSanitizer">
                     https://github.com/google/sanitizers/wiki/AddressSanitizer</a>
            <ul>
              <li>&rarr; clang compiler flag <code>-fsanitize=address</code></li>
              <li>&rarr; detects dangling pointer dereference, stack buffer overflow, 
                         non-deterministic initialization, etc.</li>
              <li>&rarr; essentially implemented as LLVM ("optimization") pass</li>
              <li>&rarr; very low overhead: typically ~2x</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/mapd_banner.png" width="200" height="auto" alt="xxx" class="logo-tr">
            <br><br><br><br>
            <h3 style="margin: 0px;">MapD &mdash; a visualization tool for big data</h3>
            <a target="_blank" 
              href="https://devblogs.nvidia.com/parallelforall/mapd-massive-throughput-database-queries-llvm-gpus/">
                    https://devblogs.nvidia.com/parallelforall/mapd-massive-throughput-database-queries-llvm-gpus/</a>
            <ul>
              <li>&rarr; JIT compiles database queries for runtime efficiency</li>
              <li>&rarr; code generation time under 30ms</li>
              <li>&rarr; LLVM IR to target specific CPU and/or GPU</li>
              <li>&rarr; uses system runtime information as compile-time input for queries</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/souper-cse-logo.png" width="160" height="auto" alt="xxx" class="logo-tr" style="margin: 20px;">
            <br><br><br><br>
            <h3 style="margin: 0px;">Souper &mdash; an automatic optimizer</h3>
            <a target="_blank" href="https://github.com/google/souper">
                                     https://github.com/google/souper</a>
            <ul>
              <li>&rarr; theorem solver to identify peephole optimizations</li>
              <li>&rarr; mostly eliminating dead code by tracking value ranges</li>
              <li>&rarr; e.g. save 4 bytes in some bitwise operation &mdash; not much but happens around 21k times when compiling LLVM</li>
              <li>&rarr; research targets systems that learn optimization automatically</li>
            </ul>
            <aside class="notes">
              * compiler ouput is far from optimum
              * not because devs are stupid, but code transformations have side effects (already with simple ones like inlining or const folding)
              * much opportunity for tiny optimizations -> writing them manually makes it hard to get correctness
              * uses an SMT solver (basically constraint satisfaction)
            </aside>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/emscripten_logo_full.png" width="408" height="111" alt="xxx" class="logo-tr">
            <br><br><br>
            <h3 style="margin: 0px;">Emscripten &mdash; a source-to-source compiler</h3>
            <a target="_blank"
               href="https://github.com/kripken/emscripten">
                     https://github.com/kripken/emscripten</a>
            <ul>
              <li>&rarr; compiles C/C++ to asm.js</li>
              <li>&rarr; examples: Unreal Engine 3, SQLite, Lua VM</li>
              <li>&rarr; <i>"near-native"</i> speed, but very depending on use-case and client setup</li>
              <li>&rarr; <b>note:</b> code size grows rapidly &mdash; less efficient transfer, parsing and locality of reference</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/wasm-logo.png" width="auto" height="180" alt="xxx" class="logo-tr">
            <br>
            <h3 style="margin: 0px;">Binaryen &mdash;<br> the WebAssembly toolchain</h3>
            <a target="_blank" 
              href="https://github.com/WebAssembly/binaryen">
                    https://github.com/WebAssembly/binaryen</a>
            <ul>
              <li>&rarr; <b>wasm</b>: portable, size- and load-time-efficient format suitable for compilation to the web</li>
              <li>&rarr; <b>binaryen</b>: parse &amp; compile to &amp; from wasm, interprete and polyfill (fallback to asm.js)</li>
              <li>&rarr; implemented as virtual Instruction Set Architecture directly in the upstream LLVM repo</li>
              <li>&rarr; initial support in clang <a target="_blank" href="http://reviews.llvm.org/rL246814">already merged back</a></li>
              <li>&rarr; plans are to ship MVP before end of 2016!</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/juce-logo.svg" width="200" height="auto" alt="xxx" class="logo-tr">
            <br><br><br><br><br>
            <h3 style="margin: 0px;">Projucer &mdash; a live coding environment</h3>
            <a target="_blank" href="https://youtu.be/imkVkRg-geI?t=124">
                                     https://youtu.be/imkVkRg-geI?t=123</a>
            <ul>
              <li>&rarr; compiles JUCE C++ components on-the-fly and links them into a running executable</li>
              <li>&rarr; rapid development of C++ based UI</li>
            </ul>
          </section>
          <section class="section-tl">
            <img data-src="img/projects/Question_mark.svg" width="auto" height="200" alt="xxx" class="logo-tr">
            <br><br><br>
            <h3 style="margin: 0px;">StatefulJIT &mdash; a research project</h3>
            <a target="_blank" href="https://github.com/weliveindetail/StatefulJit">
                                     https://github.com/weliveindetail/StatefulJit</a>
            <ul>
              <li>&rarr; experimental implementation of a minimalistic language</li>
              <li>
                &rarr; playground to evaluate compiler-based techniques for 
                <a target="_blank" href="https://en.wikipedia.org/wiki/Dynamic_software_updating">dynamic software updating</a>
              </li>
              <li>&rarr; current focus is runtime state transfer for complex data types</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3>Others..</h3>
            <ul>
              <li>
                <a target="_blank" href="https://github.com/ldc-developers/ldc">LDC</a>:
                LLVM D Compiler (alpha-state)
              </li>
              <li>
                <a target="_blank" href="https://www.rust-lang.org/">Rust</a>:
                systems programming language
              </li>
              <li>
                <a target="_blank" href="https://developer.apple.com/swift/">Swift</a>:
                Apple's attempt to replace Objective-C
              </li>
              <li>
                <a target="_blank" href="http://llvm.org/pubs/2010-09-HASKELLSYM-LLVM-GHC.pdf">GHC</a>:
                Glasgow Haskell Compiler<br>
              </li>
              <li>
                <a target="_blank" href="https://bitbucket.org/purelang/pure-lang/wiki/Faust2">FAUST</a>:
                Functional Audio Stream
              </li>
              <li>
                <a target="_blank" href="https://github.com/rubinius/rubinius">Rubinius</a>:
                high-performance env. for running Ruby code
              </li>
              <li>
                <a target="_blank" href="https://github.com/dotnet/llilc">LLILC</a>:
                aims to compile .NET's CoreCLR to LLVM IR<br>
              </li>
              <li>
                <a target="_blank" href="http://vuo.org/node/31">Vuo</a>:
                Visual programming environment
              </li>
              <li>
                and so on...
              </li>
            </ul>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <br><br><br>
            <h3 style="text-align: left;">Slight detour to...</h3>
            <h1 style="text-align: center;">Compiler<br>Construction</h1>

            <img class="fragment fade-in abspos" style="left: 3%; top: 60%;" frament-index="0" data-src="img/cc/books/0.jpg" alt="xxx">
            <img class="fragment fade-in abspos" style="left: 55%; top: 55%;" frament-index="1" data-src="img/cc/books/1.jpg" alt="xxx">
            <img class="fragment fade-in abspos" style="left: 30%; top: 45%;" frament-index="2" data-src="img/cc/books/2.jpg" alt="xxx">
            <img class="fragment fade-in abspos" style="left: 80%; top: 20%;" frament-index="3" data-src="img/cc/books/3.jpg" alt="xxx">

            <aside class="notes">
              Well-understood in computer science
            </aside>
          </section>
          <section>
            <h3>What is the goal?</h3>
            <div class="fragment" data-fragment-index="1">
              <img data-src="img/cc/helloworld_cpp.png" width="300" height="auto" alt="xxx" style="border: 0px; vertical-align: middle;">
              <span style="font-size: 200px; vertical-align: middle; margin: 50px;">&rarr;</span>
              <img data-src="img/cc/helloworld_asm.jpg" width="200" height="auto" alt="xxx" style="border: 0px; vertical-align: middle;">
            </div>
          </section>
          <section>
            <h3>Native code generation step by step</h3>
            <img class="fragment current-visible replace" frament-index="0" data-src="img/cc/src-to-exec-0.svg" alt="xxx">
            <img class="fragment current-visible replace" frament-index="1" data-src="img/cc/src-to-exec-1.svg" alt="xxx">
            <img class="fragment current-visible replace" frament-index="2" data-src="img/cc/src-to-exec-2.svg" alt="xxx">
            <img class="fragment current-visible replace" frament-index="3" data-src="img/cc/src-to-exec-3.svg" alt="xxx">
            <br><br><br><br>
            <!--<p class="fragment" data-fragment-index="4" style="font-size: 200px; text-align: left; margin-top: -150px; padding-left: 165px; color: #d22;">&uarr;</p>-->
          </section>
          <section>
            <h3>Phases of compilation</h3>
            <img class="fragment current-visible fade-in replace" frament-index="0" data-src="img/cc/src-to-asm-0.svg" alt="xxx">
            <img class="fragment current-visible fade-in replace" frament-index="1" data-src="img/cc/src-to-asm-1.svg" alt="xxx">
            <img class="fragment current-visible fade-in replace" frament-index="2" data-src="img/cc/src-to-asm-2.svg" alt="xxx">
            <img class="fragment current-visible fade-in replace" frament-index="3" data-src="img/cc/src-to-asm-3.svg" alt="xxx">
            <img class="fragment current-visible fade-in replace" frament-index="4" data-src="img/cc/src-to-asm-phases.svg" alt="xxx" style="margin-top: -7px;">
            <br><br><br><br>
            <aside class="notes">
              AST: redundancy
              IR: Static Single Assignment / 3-Adress-Code
            </aside>
          </section>
          <section>
            <h3>Three-Phase-Design</h3>
            <div style="width: 50%; height: 300px; margin: 0px 25%; text-align: center;">
              <img class="fragment current-visible fade-in replace" frament-index="0" data-src="img/arch/three-phase.svg" alt="xxx">
              <img class="fragment current-visible fade-in replace" frament-index="1" data-src="img/arch/three-phase-ir.svg" alt="xxx">
            </div>
            <p class="fragment" frament-index="2">
            </p>
            <aside class="notes">
              * boarder set of programmers: better test coverage &amp; more potential contributers
              * different skills for implementing a front-end/optimizer/back-end
              * GCC not reusable as library, because it's designed as a monolithic application (no strict separation of frontend/optimizer/backend)
              * JVM and .Net are opaque virtual machines (optimizer - backend not modular)
            </aside>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h1>LLVM IR</h1>
          </section>
          <section class="section-tl">
            <h3>Example</h3>
            <pre style="font-size: 0.5em;"><code class="x86asm hljs" style="max-height: 100%;" data-trim>
; Declare the string constant as a global constant.
@.str = private unnamed_addr constant [13 x i8] c"hello world\0A\00"

; External declaration of the puts function
declare i32 @puts(i8* nocapture) nounwind

; Definition of main function
define i32 @main() {   ; i32()*
  ; Convert [13 x i8]* to i8  *...
  %cast210 = getelementptr [13 x i8], [13 x i8]* @.str, i64 0, i64 0

  ; Call puts function to write out the string to stdout.
  call i32 @puts(i8* %cast210)
  ret i32 0
}

; Named metadata
!0 = !{i32 42, null, !"string"}
!foo = !{!0}
            </code></pre>
          </section>
          <section class="section-tl">
            <h3>Properties</h3>
            <ul>
              <li>&rarr; Static Single Assignment (SSA)</li>
              <li>&rarr; type safety, low-level operations, flexibility</li>
              <li>&rarr; source language neutral</li>
              <li>&rarr; not platform specific</li>
              <li>&rarr; <a target="_blank" href="http://llvm.org/docs/LangRef.html">http://llvm.org/docs/LangRef.html</a></li>
            </ul>
            <aside class="notes">
              * can hold meta data, e.g. debug info! unlike GCC's GIMPLE --> accesses front-end AST
            </aside>
          </section>
          <section class="section-tl">
            <h3>Representations</h3>
            <ul>
              <li>&rarr; in-memory compiler IR</li>
              <li>&rarr; on-disk bitcode representation</li>
              <li>&rarr; human readable text form</li>
            </ul>
            <aside class="notes">
              Optimization for:
              * fast access/processing
              * fast serialization/deserialization
              * readablility
            </aside>
          </section>
          <section class="section-tl">
            <h3>Restrictions</h3>
            <ul>
              <li>&rarr; designed for compiler optimizations</li>
              <li>&rarr; neither fully portable nor fully stable</li>
            </ul>
            <aside class="notes">
              * not necessarily identical on different platforms
              * Google (Portable) Native Client ---> issues
            </aside>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h1 style="text-align: center;">Conceptual Advantages</h1>
          </section>
          <section class="section-tl">
            <h3>Reusability is the key</h3>
            <ul>
              <li>&rarr; extremely reuse-friendly:<br>due to modular design and permissive license</li>
              <li>&rarr; static compilers and runtime compilers in one framework</li>
              <li>&rarr; large active community:<br>
                  <a target="_blank" href="http://lists.llvm.org/pipermail/llvm-dev/">http://lists.llvm.org/pipermail/llvm-dev/</a><br>
                  <a target="_blank" href="http://lists.llvm.org/pipermail/cfe-dev/">http://lists.llvm.org/pipermail/cfe-dev/</a></li>
              <li>&rarr; in your own project? maybe tomorrow!</li>
              <li>&rarr; <b>demo time!</b></li>
            </ul>
            <aside class="notes">
            </aside>
          </section>
          <section class="section-tl">
            <h3>Modular Optimizer</h3>
            <ul>
              <li>&rarr; IR is the only interface</li>
              <li>&rarr; pipeline of distinct optimization passes</li>
              <li>&rarr; pass manager for dependency resolution and scheduling</li>
              <li>&rarr; <a target="_blank" href="http://llvm.org/docs/WritingAnLLVMPass.html">
                                                  http://llvm.org/docs/WritingAnLLVMPass.html</a></li>
            </ul>
          </section>
          <section class="section-tl">
            <h3>Link-Time Optimization</h3>
            <img data-src="img/aosa/LTO.png" alt="xxx" width="100%" height="auto" style="border: 0px;">
            <ul>
              <li>&rarr; no expensive serialization (naturally)</li>
              <li>&rarr; across different source languages</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3>Install-Time Optimization</h3>
            <img data-src="img/aosa/ITO.png" alt="xxx" width="100%" height="auto" style="border: 0px;">
            <ul>
              <li>&rarr; delay codegen to installation (still AOT)</li>
              <li>&rarr; instruction selection &amp; scheduling for specific machine</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3>Unit Testing the Optimizer</h3>

            With textual IR &amp; modular optimizer:
            <ul>
              <li>&rarr; unit tests for single optimization passes!</li>
              <li>&rarr; e.g. make sure constant folding actually performed</li>
              <li>&rarr; typical problem with source code files as input: front-ends do constant folding too!</li>
            </ul>
            <aside class="notes">
              Traditional approaches:
              * run .c file through compiler to test that it doesn't crash (GCC)
              * compile huge programs with nightly builds and run automated user-interactions (MSVC)
            </aside>
          </section>
          <section class="section-tl">
            <h3>Why LLVM? Why now?</h3>
            <ul>
              <li>&rarr; people build compilers since 1952</li>
              <li>&rarr; from the scientific point of view there is nothing new</li>
            </ul>
            <aside class="notes">
              * first compiler by Grace Hopper
              * first FORTRAN compiler released in 1957 - took 18 person-years
              * similar IR's in JVM and .Net
              * Three-Phase-Design is well understood and implemented in other experimental compilers like SUIF, but more specific research and not production ready
            </aside>
          </section>
          <section class="section-tl">
            <h3>In the right spot at the right time!</h3>
            <ul>
              <li>&rarr; native programming is back!</li>
              <li>&rarr; many new architectures for mobile processors and GPUs</li>
              <li>&rarr; instead of getting clocked faster, instruction sets are getting weirder</li>
              <li>&rarr; high demand for compiler-based build tools</li>
            </ul>
            <aside class="notes">
              * interest and investing in C++ and compilers grows again since 2010
              * existing C++ compilers lack extensibility, while new standards arise
              * weirder: instruction-level parallelism with VeryLongInstructionWords, Vectorization, massively parallel GPUs
            </aside>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h1 style="text-align: center;">Getting Started</h1>
          </section>
          <section class="section-tl">
            <h3>Setup</h3>
            <ul>
              <li>
                &rarr; Build from source with CMake:<br>
                <a target="_blank" href="http://llvm.org/docs/CMake.html">http://llvm.org/docs/CMake.html</a><br>
                <a target="_blank" href="http://clang.llvm.org/get_started.html">http://clang.llvm.org/get_started.html</a>
              </li>
              <li>
                &rarr; Pre-built binaries:<br>
                <a traget="_blank" href="http://llvm.org/releases/download.html">http://llvm.org/releases/download.html</a>
              </li>
              <li>
                &rarr; Homebrew on Mac:<br>
                <code>
                  $ brew install llvm --with-clang --with-asan
                  &nbsp;&nbsp;&nbsp;&nbsp;
                  &nbsp;&nbsp;&nbsp;&nbsp;
                  &nbsp;&nbsp;&nbsp;&nbsp;
                  &nbsp;&nbsp;&nbsp;&nbsp;
                  &nbsp;&nbsp;&nbsp;&nbsp;
                                      --with-libcxx --HEAD
                </code>
              </li>
              <li>
                &rarr; Scoop on Windows:<br>
                <code>$ scoop install llvm</code>
              </li>
            </ul>
          </section>
          <section class="section-tl">
            <h3>Checkout the tools</h3>

            See what IR clang generates from C++
            <ul>
              <li>
                &rarr; browser: 
                <a target="_blank" href="http://ellcc.org/demo/index.cgi">
                                         http://ellcc.org/demo/index.cgi</a>
              </li>
              <li>
                &rarr; bash: <code>$ clang++ -S -emit-llvm foo.cpp</code>
              </li>
            </ul>
            <br>
            Run your IR to see what it does:
            <ul>
              <li>
                &rarr; browser: 
                <a target="_blank" href="http://kripken.github.io/llvm.js/demo.html">
                                         http://kripken.github.io/llvm.js/demo.html</a>
              </li>
              <li>
                &rarr; bash: <code>$ lli foo.ll</code>
              </li>
            </ul>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">Explore code generation</h3>
            <a target="_blank" href="http://github.com/weliveindetail/JitFromScratch">
                                     http://github.com/weliveindetail/JitFromScratch</a>
            <ul>
              <li>&rarr; get familiar with the API for IR codegen</li>
              <li>&rarr; general approach is <i>"see how clang does it"</i></li>
              <li>&rarr; few answers on stackoverflow</li>
              <li>&rarr; can be challenging</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">Learn basic front-end construction</h3>
            <a target="_blank" href="http://llvm.org/docs/tutorial/index.html">
                                     http://llvm.org/docs/tutorial/index.html</a>
            <ul>
              <li>&rarr; guided conventional C++ coding</li>
              <li>&rarr; great starting point for language experiments</li>
              <li>&rarr; focus is on functionality, not on good style!</li>
              <li>&rarr; easy but time-consuming</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">Learn how to write a pass</h3>
            <a target="_blank" href="http://llvm.org/docs/WritingAnLLVMPass.html">
                                     http://llvm.org/docs/WritingAnLLVMPass.html</a>
            <ul>
              <li>&rarr; guided C++ coding</li>
              <li>&rarr; requires some compiler and IR insight</li>
              <li>&rarr; useful for optimization or instrumentation</li>
              <li>&rarr; advanced</li>
            </ul>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

        <section>
          <section>
            <h1 style="text-align: center;">Learning from LLVM</h1>
          </section>
          <section class="section-tl">
            <blockquote cite="http://www.aosabook.org/en/llvm.html">
              None of the subsystems in LLVM are really good until they have been rewritten at least once.
            </blockquote>
            <blockquote cite="http://www.aosabook.org/en/llvm.html">
              After all, the goal isn't to be perfect, it is to keep getting better over time.
              <cite>Chris Lattner</cite>
            </blockquote>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">LLVM Coding Standards</h3>
            <a target="_blank" href="http://llvm.org/docs/CodingStandards.html">
                                     http://llvm.org/docs/CodingStandards.html</a>
            <ul>
              <li>&rarr; good coverage, great reasoning</li>
              <li>&rarr; few style conventions like naming and bracing</li>
              <li>&rarr; <i>"only pay for what you use"</i> compatible</li>
            </ul>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">Hand-rolled RTTI</h3>
            <a target="_blank" href="http://llvm.org/docs/HowToSetUpLLVMStyleRTTI.html">
                                     http://llvm.org/docs/HowToSetUpLLVMStyleRTTI.html</a>

            <pre style="width: 99%;"><code class="cpp hljs" data-trim>
static bool isLoopInvariant(const Value *V, const Loop *L) {
  if (isa&lt;Constant&gt;(V) || isa&lt;Argument&gt;(V) || isa&lt;GlobalValue&gt;(V))
    return true;

  // Otherwise, it must be an instruction...
  return !L->contains(cast&lt;Instruction&gt;(V)->getParent());
}
            </code></pre>

            <ul>
              <li>&rarr; more efficient and flexible then built-in RTTI</li>
              <li>&rarr; fully explicit &mdash; use only where necessary</li>
              <li>&rarr; no implicit limitations</li>
            </ul>
            <aside class="notes">
              * built-in RTTI limitation: dynamic_cast only works on classes that have a v-table
            </aside>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;"><code>ilist&lt;T&gt;</code> &mdash; an intrusive doubly-linked list</h3>
            <a target="_blank" style="font-size: 0.9em;" href="http://llvm.org/docs/ProgrammersManual.html#llvm-adt-ilist-h">
                                     http://llvm.org/docs/ProgrammersManual.html#llvm-adt-ilist-h</a>

            <ul>
              <li>&rarr; used for Instructions, BasicBlocks, etc.</li>
              <li>&rarr; minimum-overhead (never touch the heap)</li>
              <li>&rarr; efficiently stores polymorphic objects</li>
              <li>&rarr; no invalidation on modification &amp; constant-time splice</li>
              <li>&rarr; STL-compliant &amp; recently <a target="_blank" href="https://groups.google.com/forum/#!topic/llvm-dev/wGBO6J-ttZQ">cleaned up</a></li>
            </ul>

            <aside class="notes">
              * traversal logic requires no knowledge of the downcast nodes
              * never touch the heap
            </aside>
          </section>
          <section class="section-tl">
            <h3 style="margin: 0px;">Bugpoint</h3>
            <a target="_blank" href="http://llvm.org/docs/Bugpoint.html">
                                     http://llvm.org/docs/Bugpoint.html</a>

            <ul>
              <li>&rarr; automatically reduces the amount of code necessary to reproduce a bug</li>
              <li>&rarr; trade off programmer time for computer time</li>
            </ul>
          </section>
        </section>

        <!-- ------------------------------------------------------------------------------------------------------------------ -->

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'concave', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
